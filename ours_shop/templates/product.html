{% extends "base/base.html" %}
{% load static %}
{% load humanize %}
{% load render_partial %}
{% include rating.html %}


{% block content %}
<div id="container">
    <div class="container">
      <!-- Breadcrumb Start-->
      <ul class="breadcrumb">
        <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a href="{% url 'get_products' %}" itemprop="url"><span itemprop="title"><i class="fa fa-home"></i></span></a></li>
        <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a href="{% url 'category' product.category %}" itemprop="url"><span itemprop="title">{{product.category}}</span></a></li>
        <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a href="" itemprop="url"><span itemprop="title">{{product.name}}</span></a></li>
      </ul>
      <!-- Breadcrumb End-->
      <div class="row">
        <!--Middle Part Start-->
        <div id="content" class="col-sm-9">
          <div itemscope itemtype="http://schema.org/محصولات">
            <h1 class="title" itemprop="name">{{product.name}}</h1>
            <div class="row product-info">
              <div class="col-sm-6">
                <div class="image"><img class="img-responsive" itemprop="image" id="zoom_01" src="{{product.picture.url}}" title="لپ تاپ ایلین ور" alt="لپ تاپ ایلین ور" data-zoom-image="image/product/macbook_air_1-600x900.jpg" /> </div>
                <div class="center-block text-center"><span class="zoom-gallery"><i class="fa fa-search"></i> برای مشاهده گالری روی تصویر کلیک کنید</span></div>
                  <div class="image-additional" id="gallery_01"> <a class="thumbnail" href="#" data-zoom-image="image/product/macbook_air_1-600x900.jpg" data-image="image/product/macbook_air_1-350x525.jpg" title="لپ تاپ ایلین ور"> 
                    {% for item in product.gallery %}
                    <a class="thumbnail" href="#" data-zoom-image="image/product/macbook_air_3-600x900.jpg" 
                     data-image="image/product/macbook_air_3-350x525.jpg" title="لپ تاپ ایلین ور"><img style="height: 100px; width: 100px;"
                      src="{{item.image.url}}" title="لپ تاپ ایلین ور" alt="لپ تاپ ایلین ور" /></a>
                    {% endfor %}  
                  </div>
              </div>
              {% if product.active %}
                <div class="col-sm-6">
                    <ul class="list-unstyled description">
                    {% if product.full_sale %}
                      <li><b>وضعیت موجودی :</b> <span class="instock">موجود</span></li>
                    {% else %}
                       <li><b>وضعیت موجودی :</b> <span class="nostock">ناموجود</span></li>
                    {% endif %}
                    </ul>
                    <ul class="price-box">
                    {% if product.especial %}
                    <li class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer"><span class="price-old">{{product.price | intcomma }} تومان</span> <span itemprop="price">
                        {{product.sale_price | intcomma }} تومان<span itemprop="availability" content="موجود"></span></span></li>
                    {% else %} 
                    <li class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer"><span itemprop="price">
                        {{product.price | intcomma }} تومان
                        <span itemprop="availability" content="موجود"></span></span>
                    </li>
                    {% endif %}       
                    <li></li>
                    
                    </ul>
                    
                    <div id="product">
                     
                    <h3 class="subtitle">انتخاب های در دسترس</h3>
                        <div class="form-group required">
                            <label class="control-label">رنگ</label>
                            <select class="form-control" id="color_product" name="option[200]">
                             <option > ------ </option>
                            {% for item in product.color %}
                              <option  value="{{item.name}}"id="color_product">{{item.name}}</option>
                            {% endfor %} 
                            </select> 
                        </div>
                      <div class="cart">
                             {% comment %}
                              <div class="qty">
                                  <label class="control-label" for="input-quantity">تعداد</label>
                                  <input type="text" name="quantity" value="1" size="2" id="input-quantity" class="form-control" />
                                  <a class="qtyBtn plus" href="javascript:void(0);">+</a><br />
                                  <a class="qtyBtn mines" href="javascript:void(0);">-</a>
                                  <div class="clear"></div>
                              </div>
                              {% endcomment %}
                              {% if product.full_sale %} 
                                <button type="button" value="{{product.id}}" style="border-radius: 5px; padding: 8px;" 
                                id="cart_add" class="btn btn-primary btn-lg col-md-12">افزودن به سبد</button>
                              {% endif %}  
                          <div>
                            <br>
                          <button type="button" value="{{product.id}}" id="wishlist_id" class="wishlist" onClick=""><i class="fa fa-heart"></i> افزودن به علاقه مندی ها</button>
                          <button type="button" class="wishlist" onClick=""><i class="fa fa-exchange"></i> مقایسه این محصول</button>
                          </div>
                      </div>
                      <div class="rating-container" style="margin-top: 30px;">
                        <!-- Display Average Rating -->
                          <div class="col-lg-6" style="margin-bottom: 10px;">
                              <div class="rating" style="margin-left: 10px;">
                                {% for i in "12345" %}
                                    {% if average_rating >= forloop.counter %}
                                        ★
                                    {% else %}
                                        ☆
                                    {% endif %}
                                {% endfor %}
                              </div>
                            <h1>({{ average_rating }})</h1>
                          </div>
                         <!-- Rating Form -->
                         <div class="col-sm-6">
                         {% if user.is_authenticated %} 
                             <form method="post">
                                 {% csrf_token %}
                                 {{ form.stars }}
                                 <button type="submit" class="btn-primary" style="margin: auto; padding: 10px; border-radius: 9px;">رای دادن</button>
                             </form> 
                           {% endif %}
                         </div>
                       </div>
                    </div>
                    <div class="rating" itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
                    <meta itemprop="ratingValue" content="0" />
                    <!-- Display average rating -->
                      <div class="rating">
                    
                      </div>
                      <!-- Rating form -->
                    
                    </div>
                    <hr>
                    <!-- AddThis Button BEGIN -->
                    <div class="addthis_toolbox addthis_default_style"> <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_tweet"></a> <a class="addthis_button_google_plusone" g:plusone:size="medium"></a> <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal" pi:pinit:url="http://www.addthis.com/features/pinterest" pi:pinit:media="http://www.addthis.com/cms-content/images/features/pinterest-lg.png"></a> <a class="addthis_counter addthis_pill_style"></a> </div>
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-514863386b357649"></script>
                    <!-- AddThis Button END -->
                </div>
             {% else %}
                <div class="col-sm-6">
                    <ul class="list-unstyled description">
                    <li><b>برند :</b> <a href="#"><span itemprop="brand">{{product.name}}</span></a></li>
                    <li><b>کد محصول :</b> <span itemprop="mpn">{{product.id}}</span></li>
                    <li><b>امتیازات خرید:</b> 700</li>
                    <li><b>وضعیت موجودی :</b> <span class="nostock">ناموجود</span></li>
                    </ul>
                    <ul class="price-box">
                    {% if product.especial %}
                    <li class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer"><span class="price-old">{{product.price | intcomma }} تومان</span> <span itemprop="price">
                        {{product.sale_price | intcomma }} تومان<span itemprop="availability" content="ناموجود"></span></span></li>
                    {% else %} 
                    <li class="price" itemprop="offers" itemscope itemtype="http://schema.org/Offer"><span itemprop="price">
                        {{product.price | intcomma }} تومان   
                    </li>
                    {% endif %}       
                    <li></li>
                    <li>بدون مالیات : 9 میلیون تومان</li>
                    </ul>
                    <div id="product">
                    <h3 class="subtitle">انتخاب های در دسترس</h3>
                    <div class="form-group required">
                        <label class="control-label">رنگ</label>
                        <select class="form-control" id="input-option200" name="option[200]">
                        <option value=""> --- لطفا انتخاب کنید --- </option>
                        <option value="4">مشکی </option>
                        <option value="3">نقره ای </option>
                        <option value="1">سبز </option>
                        <option value="2">آبی </option>
                        </select>
                    </div>
                    <div class="cart">
                        <div>
                        <button type="button" id="wishlist" value="item.id" class="wishlist" onClick=""><i class="fa fa-heart"></i> افزودن به علاقه مندی ها</button>
                        <br />
                        <button type="button" class="wishlist" onClick=""><i class="fa fa-exchange"></i> مقایسه این محصول</button>
                        </div>
                    </div>
                    </div>
                    <div class="rating" itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
                    <meta itemprop="ratingValue" content="0" />
                    <p><span class="fa fa-stack"><i class="fa fa-star fa-stack-1x"></i><i class="fa fa-star-o fa-stack-1x"></i></span> <span class="fa fa-stack">
                      <i class="fa fa-star fa-stack-1x"></i><i class="fa fa-star-o fa-stack-1x"></i></span> <span class="fa fa-stack">
                      <i class="fa fa-star fa-stack-1x"></i><i class="fa fa-star-o fa-stack-1x"></i></span> <span class="fa fa-stack">
                      <i class="fa fa-star fa-stack-1x"></i><i class="fa fa-star-o fa-stack-1x"></i></span> <span class="fa fa-stack">
                      <i class="fa fa-star-o fa-stack-1x"></i></span> <a onClick="$('a[href=\'#tab-review\']').trigger('click'); return false;" href="">
                      <span itemprop="reviewCount">1 بررسی</span></a> / <a onClick="$('a[href=\'#tab-review\']').trigger('click'); return false;" href="">یک بررسی بنویسید</a></p>
                    </div>
                    <hr>
                    <!-- AddThis Button BEGIN -->
                    <div class="addthis_toolbox addthis_default_style"> <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_tweet"></a> <a class="addthis_button_google_plusone" g:plusone:size="medium"></a> <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal" pi:pinit:url="http://www.addthis.com/features/pinterest" pi:pinit:media="http://www.addthis.com/cms-content/images/features/pinterest-lg.png"></a> <a class="addthis_counter addthis_pill_style"></a> </div>
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-514863386b357649"></script>
                    <!-- AddThis Button END -->
                </div>
             {% endif %}   
            </div>
            <ul class="nav nav-tabs">
              <li class="active"><a href="#tab-description" data-toggle="tab">توضیحات</a></li>
              <li><a href="#tab-specification" data-toggle="tab">مشخصات</a></li>
              <li><a href="#tab-review" data-toggle="tab">بررسی (2)</a></li>
            </ul>
            <div class="tab-content">
              <div itemprop="description" id="tab-description" class="tab-pane active">
                <div>
                  <p><b>{{product.description}}</b></p>
                 
                </div>
              </div>
              <div id="tab-specification" class="tab-pane">
                <div id="tab-specification" class="tab-pane">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <td colspan="2"><strong>حافظه</strong></td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>تست 1</td>
                      <td>8gb</td>
                    </tr>
                  </tbody>
                  </table>
                <table class="table table-bordered">
                <thead>
                    <tr>
                      <td colspan="2"><strong>پردازشگر</strong></td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>تعداد هسته</td>
                      <td>1</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              </div>
              <div id="tab-review" class="tab-pane">
                <form class="form-horizontal">
                  <div id="review">
                    <div>
                      <table class="table table-striped table-bordered">
                        <tbody>
                          <tr>
                            <td style="width: 50%;"><strong><span>هاروی</span></strong></td>
                            <td class="text-right"><span>1395/1/20</span></td>
                          </tr>
                          <tr>
                            <td colspan="2"><p>ارائه راهکارها و شرایط سخت تایپ به پایان رسد وزمان مورد نیاز شامل حروفچینی دستاوردهای اصلی و جوابگوی سوالات پیوسته اهل دنیای موجود طراحی اساسا مورد استفاده قرار گیرد.</p>
                              <div class="rating"> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> </div></td>
                          </tr>
                        </tbody>
                      </table>
                      <table class="table table-striped table-bordered">
                        <tbody>
                          <tr>
                            <td style="width: 50%;"><strong><span>اندرسون</span></strong></td>
                            <td class="text-right"><span>1395/1/20</span></td>
                          </tr>
                          <tr>
                            <td colspan="2"><p>ارائه راهکارها و شرایط سخت تایپ به پایان رسد وزمان مورد نیاز شامل حروفچینی دستاوردهای اصلی و جوابگوی سوالات پیوسته اهل دنیای موجود طراحی اساسا مورد استفاده قرار گیرد.</p>
                              <div class="rating"> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star fa-stack-2x"></i><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-2x"></i></span> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-2x"></i></span> </div></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <div class="text-right"></div>
                  </div>
                  <h2>یک بررسی بنویسید</h2>
                  <div class="form-group required">
                    <div class="col-sm-12">
                      <label for="input-name" class="control-label">نام شما</label>
                      <input type="text" class="form-control" id="input-name" value="" name="name">
                    </div>
                  </div>
                  <div class="form-group required">
                    <div class="col-sm-12">
                      <label for="input-review" class="control-label">بررسی شما</label>
                      <textarea class="form-control" id="input-review" rows="5" name="text"></textarea>
                      <div class="help-block"><span class="text-danger">توجه :</span> HTML بازگردانی نخواهد شد!</div>
                    </div>
                  </div>
                  <div class="form-group required">
                    
                    <div class="col-sm-12">
                      <label class="control-label">رتبه</label>
                      &nbsp;&nbsp;&nbsp; بد&nbsp;
                      <input type="radio" value="1" name="rating">
                      &nbsp;
                      <input type="radio" value="2" name="rating">
                      &nbsp;
                      <input type="radio" value="3" name="rating">
                      &nbsp;
                      <input type="radio" value="4" name="rating">
                      &nbsp;
                      <input type="radio" value="5" name="rating">
                      &nbsp;خوب</div>
                  </div>
                  <div class="buttons">
                    <div class="pull-right">
                      <button class="btn btn-primary" id="button-review" type="button">ادامه</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
            <h3 class="subtitle">محصولات مرتبط</h3>
            <div class="owl-carousel related_pro">
              {% for item in realyted_product %}
              <div class="product-thumb">
                <div class="image"><a href="{% url 'product' item.id %}"><img src="{{item.picture.url}}"  style="width: 100px; height: 100px;" alt="تبلت ایسر" title="تبلت ایسر" class="img-responsive" /></a></div>
                <div class="caption">
                  <h4><a href="{% url 'product' item.id %}">{{item.name}}</a></h4>
                  <p class="price"> <span class="price-new">98000 تومان</span> <span class="price-old">240000 تومان</span> <span class="saving">{{item.discount}}</span> </p>
                  <div class="rating"> 
                      <div class="rating-container">
                          {% with ''|center:5 as range %}
                          {% for _ in range %}
                              {% if item.avg_rating >= forloop.counter %}
                                  ★
                              {% else %}
                                  ☆
                              {% endif %}
                          {% endfor %}
                          {% endwith %}
                          ({{ item.avg_rating|default:0|floatformat:1 }})
                      </div>
                   </div>
                </div>
                <div class="button-group">
                  <form method="post" action="{% url 'add_cart_product' item.id %}">
                    {% csrf_token %}
                    {% if item.full_sale %}
                        <button type="submit" style="background-color: #4CAF50;
                        color: white;
                        padding: 5px 10px;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;">افزود به سبد</button>
                    {% else %}
                        <div style="background-color: #c10c0c;
                        color: white;
                        width: 100px;
                        padding: 5px 10px;
                        margin-right: 30px;
                        height: 32px;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;">ناموجود </div>
                    {% endif %}
                  </form>
                  <div class="add-to-links">
                    <form method="post" action="{% url 'add_wishlist' item.id %}">
                      {% csrf_token %}
                      <button type="submit"  data-toggle="tooltip"
                      title="افزودن به علاقه مندی" onClick=""><i class="fa fa-heart"></i></button>
                    </form>
                    <button type="button" data-toggle="tooltip" title="افزودن به مقایسه" onClick=""><i class="fa fa-exchange"></i></button>
                  </div>
                </div> 
              </div>
              {% endfor %}
            </div>

          </div>
        </div>
        <!--Middle Part End -->
        <!--Right Part Start -->
        <aside id="column-right" class="col-sm-3 hidden-xs">
        {% comment %}
          <h3 class="subtitle">پرفروش ها</h3>
        {% for item in full_sale %}
          <div class="side-item">
            <div class="product-thumb clearfix">
              <div class="image"><a href="{% url 'product' item.id %}"><img src={{item.picture.url}} alt="تی شرت کتان مردانه" title="تی شرت کتان مردانه" class="img-responsive" /></a></div>
              <div class="caption">
                {% if item.especial %}
                <h4><a href="{% url 'product' item.id %}">{{item.name}}</a></h4>
                <p class="price"><span class="price-new">{{item.sale_price}}</span> <span class="price-old">{{item.price}}</span> <span class="saving">-10%</span></p>
                {% else %}
                <h4><a href="product.html">{{item.name}}</a></h4>
                <p class="price"><span class="price-new">{{item.price}}</span><span class="saving">-10%</span></p>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %} 
       
          <div class="list-group">
            <h3 class="subtitle">محتوای سفارشی</h3>
            <p>این یک بلاک محتواست. هر نوع محتوایی شامل html، نوشته یا تصویر را میتوانید در آن قرار دهید. </p>
            <p> در این صورت می توان امید داشت که تمام و دشواری موجود در ارائه راهکارها و شرایط سخت تایپ به پایان رسد وزمان مورد نیاز شامل حروفچینی دستاوردهای اصلی و جوابگوی سوالات پیوسته اهل دنیای موجود طراحی اساسا مورد استفاده قرار گیرد. </p>
            <p>لورم ایپسوم متن ساختگی با تولید سادگی نامفهوم از صنعت چاپ و با استفاده از طراحان گرافیک است.</p>
          </div>
          {% endcomment %} 
          <h3 class="subtitle">ویژه</h3>
          <div class="side-item">
            {% for item in especial_product|slice:":13" %}
              <div class="product-thumb clearfix">
                <div class="image"><a href="{% url 'product' item.id %}"><img src="{{ item.picture.url }}" alt=" کتاب آموزش باغبانی " title=" کتاب آموزش باغبانی " class="img-responsive" /></a></div>
                <div class="caption">
                  <h4><a href="{% url 'product' item.id %}">{{item.name}}</a></h4>
                  <p class="price"> <span class="price-new">{{item.sale_price}}</span> <span class="price-old">{{item.price}}</span> <span class="saving">-26%</span> </p>
                </div>
              </div>
            {% endfor %}
          </div>
        </aside>
        <!--Right Part End -->
      </div>
    </div>
  </div>
  <script>
    $(document).on ('click', '#cart_add', function(e){
      e.preventDefault();
      $.ajax({
        type: 'POST',
        url: "{% url 'add_cart'%}",
        data: {
          product_id: $('#cart_add').val(),
          // product_qty: $('#cart-qty option:selected').text(),
          product_qty : 1,
          color_product : $('#color_product option:selected').text(),
          csrfmiddlewaretoken: '{{ csrf_token }}',
          action: 'post'
        },
        success: function(json){
          //console.log(json)
          location.reload();  
        },
        error: function(xhr, errmsg, err){
        }
      })
    })
    
    $(document).on ('click', '#wishlist_id', function(e){
      e.preventDefault();
      $.ajax({
        type: 'POST',
        url: "{% url 'add_wishlist_product'%}",
        data: {
          product_id: $('#wishlist_id').val(),
          csrfmiddlewaretoken: '{{ csrf_token }}',
          action: 'post'
        },
        success: function(json){
          //console.log(json)
          location.reload();  
        },
        error: function(xhr, errmsg, err){
        }
      })
    })
  </script>
{% endblock %}